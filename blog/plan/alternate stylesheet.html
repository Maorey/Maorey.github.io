<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一种基于 alternate stylesheet 的整站换肤方案 | 玉书</title>
    <meta name="description" content="毛瑞的博客">
    <link rel="stylesheet" href="/assets/style.f43144b4.css">
    <link rel="modulepreload" href="/assets/Home.31883e73.js">
    <link rel="modulepreload" href="/assets/vssue.b6a2efcd.js">
    <link rel="modulepreload" href="/assets/viewer.96748a50.js">
    <link rel="modulepreload" href="/assets/echarts.d4af4091.js">
    <link rel="modulepreload" href="/assets/flowchart.31c8d424.js">
    <link rel="modulepreload" href="/assets/mermaid.f217129e.js">
    <link rel="modulepreload" href="/assets/runner.ec9056a7.js">
    <link rel="modulepreload" href="/assets/app.f71ae3c3.js">
    <link rel="modulepreload" href="/assets/blog_plan_alternate stylesheet.md.2c14e3ca.lean.js">
    <link rel="modulepreload" href="/assets/app.f71ae3c3.js">
    <link rel="icon" href="/logo.jpg">
    <meta name="twitter:title" content="一种基于 alternate stylesheet 的整站换肤方案 | 玉书">
    <meta property="og:title" content="一种基于 alternate stylesheet 的整站换肤方案 | 玉书">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-5df6160f><div class="sidebar-button" data-v-5df6160f><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="玉书, back to home" data-v-5df6160f data-v-8dbfef3c><img class="logo" src="/logo.jpg" alt="Logo" data-v-8dbfef3c> 玉书</a><div class="flex-grow" data-v-5df6160f></div><div class="nav" data-v-5df6160f><nav class="nav-links" data-v-5df6160f data-v-38e3b123><!--[--><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item active" href="/blog/" data-v-45eb32c6>博客 <!----></a></div></div><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item" href="/diary/" data-v-45eb32c6>日记 <!----></a></div></div><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item" href="/about.html" data-v-45eb32c6>关于我 <!----></a></div></div><!--]--><!----><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item isExternal" href="https://github.com/Maorey/Blog" target="_blank" rel="noopener noreferrer" data-v-45eb32c6>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-45eb32c6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-58e261f2><nav class="nav-links nav" data-v-58e261f2 data-v-38e3b123><!--[--><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item active" href="/blog/" data-v-45eb32c6>博客 <!----></a></div></div><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item" href="/diary/" data-v-45eb32c6>日记 <!----></a></div></div><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item" href="/about.html" data-v-45eb32c6>关于我 <!----></a></div></div><!--]--><!----><div class="item" data-v-38e3b123><div class="nav-link" data-v-38e3b123 data-v-45eb32c6><a class="item isExternal" href="https://github.com/Maorey/Blog" target="_blank" rel="noopener noreferrer" data-v-45eb32c6>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-45eb32c6><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-58e261f2><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/js/">JavaScript笔记</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/js/iterator.html">迭代器</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/algorithm/">算法</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/algorithm/melkman.html">最小凸包</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/algorithm/pinp.html">点是否在多边形内</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/algorithm/dynamicProgramming.html">动态规划</a><!----></li></ul></li><li class="sidebar-link"><a class="sidebar-link-item" href="/blog/plan/">想法&amp;方案</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item active" href="/blog/plan/alternate stylesheet.html">一种基于 alternate stylesheet 的整站换肤方案</a><ul class="sidebar-links"><li class="sidebar-link"><a class="sidebar-link-item" href="#背景">背景</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#换肤方案">换肤方案</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#alternate-stylesheet">alternate stylesheet</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#目标">目标</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#实现思路">实现思路</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#具体实现">具体实现</a><!----></li></ul></li></ul></li><!--]--></ul><!--[--><!--]--></aside><!-- TODO: make this button accessible --><div class="sidebar-mask"></div><main class="page" data-v-d36a7fda><div class="container" data-v-d36a7fda><!--[--><!--]--><div class="content" data-v-d36a7fda><div data-v-d36a7fda><p><em>2021-06-15</em></p><h2 id="背景"><a class="header-anchor" href="#背景" aria-hidden="true">#</a> 背景</h2><p>有时候需要网站能换肤, 嗯, 就酱</p><h2 id="换肤方案"><a class="header-anchor" href="#换肤方案" aria-hidden="true">#</a> 换肤方案</h2><p>换肤有两种应用场景, 一种是构建时生成单个指定皮肤, 一种是运行时切换皮肤</p><p>TODO: 来个表格 样式覆盖(根元素加class, css优先级) css变量 alternate stylesheet 其它略(less <code>&lt;style</code> <code>&lt;link</code>)</p><h2 id="alternate-stylesheet"><a class="header-anchor" href="#alternate-stylesheet" aria-hidden="true">#</a> alternate stylesheet</h2><p>它是 <a href="https://www.w3.org/TR/html401/present/styles.html#h-14.3" target="_blank" rel="noopener noreferrer">HTML 4.01 规范</a> 中的内容, 允许切换网页使用的样式表, 详情请<a href="https://developer.mozilla.org/docs/Web/CSS/Alternative_style_sheets" target="_blank" rel="noopener noreferrer">访问MDN</a>, 浏览器兼容性还不错, 完全可以在生产环境使用</p><h2 id="目标"><a class="header-anchor" href="#目标" aria-hidden="true">#</a> 目标</h2><p>TODO: 来个表格</p><ol><li>整站换肤</li><li>易开发易维护降成本</li></ol><ul><li>默认自动注入皮肤变量同时生成多套可运行时切换的皮肤</li><li>支持异步chunk</li><li>css module / css object (<code>import STYLE from &#39;*.scss&#39;</code>) 支持</li><li>细粒度特殊处理支持: 允许指定注入的变量 &amp; 允许随皮肤切换样式和其他</li><li>易于开发调试</li></ul><ol start="3"><li>良好的扩展性 (用户定制)</li><li>无缝(刷新)切换/懒加载/预加载/按需加载皮肤</li></ol><h2 id="实现思路"><a class="header-anchor" href="#实现思路" aria-hidden="true">#</a> 实现思路</h2><p>TODO: 来个表格</p><ol><li>alternate stylesheet</li><li>scss/less... vars + webpack插件</li></ol><ul><li>loader 配置全局变量</li><li>runtime代码广播换肤事件(可自定义), 维护当前皮肤状态(全局变量, 可自定义)以待获取 (比如异步chunk)</li><li>搜集构建信息, 根据当前皮肤提供接口更新css object(如使用vue reactivity劫持下 可做到比如维护一套变量控制包括echarts在内的皮肤及切换)</li><li>提供接口, 构建时处理</li><li>支持热更新, 但暂不支持开发环境切换皮肤(style标签, 支持成本大, 要么丢热更新, 要么改style标签内容, 这都可以做成另一种换肤方案了), 支持使用指定皮肤(命令行参数)启动开发环境</li><li>暂不支持 css-in-js (styled-component 等)</li></ul><ol start="3"><li>可支持 css var、在线打包、上传css</li><li><code>&lt;link rel=&quot;preload/prefetch&quot;</code></li></ol><h2 id="具体实现"><a class="header-anchor" href="#具体实现" aria-hidden="true">#</a> 具体实现</h2><p>TODO: api/规范 + 工程化</p></div></div><footer class="page-footer" data-v-d36a7fda data-v-5a019cc9><div class="edit" data-v-5a019cc9><div class="edit-link" data-v-5a019cc9 data-v-3ae295f1><a class="link" href="https://github.com/Maorey/Blog/edit/master/docs/blog/plan/alternate stylesheet.md" target="_blank" rel="noopener noreferrer" data-v-3ae295f1>编辑本文 <svg class="icon outbound icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-3ae295f1><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div><div class="updated" data-v-5a019cc9><p class="last-updated" data-v-5a019cc9 data-v-52854a16><span class="prefix" data-v-52854a16>上次更新:</span><span class="datetime" data-v-52854a16></span></p></div></footer><div class="next-and-prev-link" data-v-d36a7fda data-v-6683615c><div class="container" data-v-6683615c><div class="prev" data-v-6683615c><a class="link" href="/blog/plan/" data-v-6683615c><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon icon-prev" data-v-6683615c><path d="M19,11H7.4l5.3-5.3c0.4-0.4,0.4-1,0-1.4s-1-0.4-1.4,0l-7,7c-0.1,0.1-0.2,0.2-0.2,0.3c-0.1,0.2-0.1,0.5,0,0.8c0.1,0.1,0.1,0.2,0.2,0.3l7,7c0.2,0.2,0.5,0.3,0.7,0.3s0.5-0.1,0.7-0.3c0.4-0.4,0.4-1,0-1.4L7.4,13H19c0.6,0,1-0.4,1-1S19.6,11,19,11z"></path></svg><span class="text" data-v-6683615c>想法&amp;方案</span></a></div><div class="next" data-v-6683615c><!----></div></div></div><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"404.md\":\"d717afff\",\"about.md\":\"d7e069c3\",\"index.md\":\"192828d8\",\"blog_index.md\":\"9dabb930\",\"diary_20210327.md\":\"f7336c3b\",\"diary_20210504.md\":\"59399ad7\",\"diary_checklist.md\":\"5248ae83\",\"diary_index.md\":\"e881c50a\",\"blog_algorithm_dynamicprogramming.md\":\"bd3aecc8\",\"blog_algorithm_index.md\":\"12e50d73\",\"blog_algorithm_melkman.md\":\"21b2254b\",\"blog_algorithm_pinp.md\":\"5c198473\",\"blog_js_index.md\":\"d9f1f431\",\"blog_js_iterator.md\":\"002b721f\",\"blog_plan_alternate stylesheet.md\":\"2c14e3ca\",\"blog_plan_index.md\":\"64b94860\"}")</script>
    <script type="module" async src="/assets/app.f71ae3c3.js"></script>
  </body>
</html>